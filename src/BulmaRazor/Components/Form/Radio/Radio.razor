
@namespace BulmaRazor.Components

@inherits BulmaComponentBase
@typeparam TValue

<label @attributes="AdditionalAttributes" class="@classes">
    <input disabled="@Disabled" name="@Name" type="radio" value="@Value" checked="@_checked" @onchange="ChangeHandle" />
    @ChildContent
</label>
@code {


    string classes => CssBuilder.Default("radio")
        .AddClassFromAttributes(AdditionalAttributes)
        .Build();

    private bool _checked;


    private async Task ChangeHandle(ChangeEventArgs e)
    {
        await Parent.UnCheckAll(Value);
        _checked = true;
    }

    public void SetChecked(bool ck)
    {
        _checked = ck;

    }

    [Parameter]
    public TValue Value { get; set; }

    [Parameter]
    public string Name { get; set; }

    [Parameter]
    public bool Disabled { get; set; }


    [CascadingParameter]
    public Radios<TValue> Parent { get; set; }


    protected override void OnInitialized()
    {
        if (Parent == null) throw new ArgumentException("Radio必须是Radios的子组件");

        base.OnInitialized();
        Parent.AddItem(this);
        if (Parent.Value.Equals(Value))
        {
            _checked = true;
        }
    }

    [Parameter]
    public RenderFragment ChildContent { get; set; }
}
